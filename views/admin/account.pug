extends ../layout.pug

block content
  div.container-account
    each user in users
      div.card-user
        div.card-header
          h4.card-title Your Account
        div.card-content
          p.card-email
            strong Email: 
            span.email-value= user.email
          .con-btn-account
            a.link-edit(onclick=`openEditPopup('${user.userId}', '${user.email}', '${user.role}')`) Change Password?
            form#deleteForm(class=`delete-form-${user.userId}` action=`/admin/account/delete/${user.userId}` method="POST")
              input(type="hidden" name="_method" value="DELETE" hidden)
              button.btn-delete(type="button" onclick=`confirmDelete('${user.userId}')`) Delete Account?


  div.account-popup-container-account.hidden-account
    div.account-popup-overlay-account(onclick="closePopup()")
    div.account-popups-account
      button.account-popup-close-account(onclick="closePopup()") âœ–
      form(method='post' action='/admin/account' id='edit')
        div.m-0-account
          input#userId-account(type='text' name='userId' hidden)
        div.mb-3-account
          label.form-label-account(for='email') 
          input#email-account.input-field-account(type='email' name='email' hidden)
        div.mb-3-account
          label.form-label-account(for='password') New Password
          input#password-account.input-field-account(type='password' name='password')
        div.mb-3-account
          label.form-label-account(for='retype-password') Re-type Password
          input#password-account.input-field-account(type='password' name='retype-password' autocomplete="off")
        div.mb-3-account
          button.btn-submit-account(type='submit') Submit New Password
          
  include ../footer.pug

  script.
    function handleClick(userId, email, password, role) {
      console.log(userId, email, password, role);
      document.getElementById('userId').value = userId;
      document.getElementById('email').value = email;
      document.getElementById('password').value = password;
      document.getElementById('role').value = role;
    }

    function confirmDelete(userId) {
      Swal.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#ff4c4c', 
        cancelButtonColor: '#29293d', 
        confirmButtonText: 'Yes, delete it!',
        cancelButtonText: 'Cancel',
        customClass: {
            popup: 'swal2-popup',
            title: 'swal2-title',
            htmlContainer: 'swal2-html-container',
            confirmButton: 'swal2-confirm',
            cancelButton: 'swal2-cancel'
        }
      }).then((result) => {
        if (result.isConfirmed) {
          const form = document.getElementById(`deleteForm-${userId}`);
          form.submit();
        }
      });
    }



